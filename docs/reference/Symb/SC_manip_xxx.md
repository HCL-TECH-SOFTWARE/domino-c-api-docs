##### Symbolic Value : Smartcards
##### SC_manip_xxx - Opcodes defined for SECManipulateSC
---
```
#include <kfm.h>
```

**Symbolic Values :**

	SC_manip_GetVersion	  -  Get the version of the specification.

	SC_manip_InitializeContext	  -  Initialize a Smartcard context.

	SC_manip_TerminateContext	  -  Terminates the Smartcard code.

	SC_manip_CheckCard	  -  Check the current Smartcard

	SC_manip_EnterIDFile	  -  Opens the indicated ID.

	SC_manip_EnterPIN	  -  Logs the user into the smartcard.

	SC_manip_SCEnableID	  -  Smartcard-enable the "entered" ID file with the current smartcard.

	SC_manip_PushInetKey	  -  Pushes the private key associated with the current signing internet certificate onto the Smartcard.

	SC_manip_FindMatchedCerts	  -  Initializes a search for importable certificates and private keys on a Smartcard.

	SC_manip_GetMatchedCert	  -  Examines the certificates that are available for import from the smartcard into the ID file. See SC_MANIP_IMPORTABLE_CERT.

	SC_manip_ImportInetCert	  -  Reads the indicated certificate from the Smartcard.

	SC_manip_RefreshTokenInfo	  -  Refreshes the token identification information that is stored in the ID file.

	SC_manip_PushKyrKey	  -  Pushes the private key from an SSL keyring file onto a smartcard or a PKCS#11-based cryptographic accelerator.

	SC_manip_PushNotesKey	  -  Pushes a "large" (1024 or 2048-bit) Notes key onto a smartcard.

	SC_manip_EnterIDPassword	  -  Unlock the non-smartcard-enabled ID file entered through EnterIDFile with the supplied password

	SC_manip_FindAllKeys	  -  Acquire all keys from all smartcards and return the number of keys available to the caller.

	SC_manip_LockIDWithKeyRO	  -  Smartcard-enable the ID file by encrypting it with a password-equivalent generated by signing a random seed value. This opcode will work with most read-only ID files.

	SC_manip_LockIDWithKeyRnd	  -  Smartcard-enable the ID file by encrypting it with a symmetric key that is wrapped by a key on the token.

	SC_manip_PushInetKeyAndCert	  -  Identical to the SC_manip_PushInetKey, except that it also push the corresponding X.509 certificate onto the smartcard or other cryptographic token.

	SC_manip_PushKyrKeyAndCert	  -  Identical to the SC_manip_PushKyrKey, except that it also push the corresponding X.509 certificate onto the smartcard or other cryptographic token.


**Description :**

SC_manip_GetVersion:        Get the version of the specification.<br>
<br>
                                  Input Parameters:<br>
                                        pContext     - Unused<br>
                                        pdwFlags     - Unused<br>
                                        pdwParam1    - points to a DWORD<br>
                                        pvParam2     - Unused<br>
<br>
                                  Output Parameters:<br>
                                        *pdwParam1   - Filled with the version of the specification. 0 for 6.0.2
<ul><br>
<br>
                             SC_manip_GetVersion is the only opcode that can be called without a valid SCMCTX.<br>
<br>
SC_manip_InitializeContext:  Initialize a Smartcard context.<br>
<br>
                                  Input Parameters:<br>
                                        pContext     - Address of a NULLSCMCTX. See NULLSCMCTX<br>
                                        pdwFlags     - Unused<br>
                                        pdwParam1    - Unused<br>
                                        pvParam2     - Unused<br>
<br>
                                  Output Parameters:<br>
                                        *pContext    - Filled with the initialized SCMCTX<br>
<br>
                             SC_manip_InitializeContext allocates a SCMCTX and initializes the PKCS #11 code. <br>
                             Returns ERR_BSAFE_SC_INVALID_CONFIG if the local smartcard config is incorrect; <br>
                             Returns ERR_BSAFE_INSERT_SMARTCARD if a token is not in the slot.<br>
                             If multiple slots are provided by the PKCS #11 DLL, this uses the first one.<br>
<br>
SC_manip_TerminateContext:   Terminates the Smartcard code.<br>
<br>
                                  Input Parameters:<br>
                                        pContext     - Valid context.<br>
                                        pdwFlags     - Unused<br>
                                        pdwParam1    - Unused<br>
                                        pvParam2     - Unused<br>
<br>
                                  Output Parameters:<br>
                                        *pContext    - Zeroed.<br>
<br>
                             Terminates the Smartcard code, cleans up the ID file if any, frees the SCMCTX, and zeroes <br>
                             *pContext.<br>
<br>
SC_manip_CheckCard:          Check the current Smartcard.<br>
<br>
                                  Input Parameters:<br>
                                        pContext      - Valid context<br>
                                        pdwFlags      - Unused<br>
                                        pdwParam1     - Unused<br>
                                        pvParam2      - Unused<br>
<br>
                                  Output Parameters:<br>
                                        None<br>
<br>
                             CheckCard determines if the current smartcard can support Notes properly, and will return<br>
                             error codes for any potential problems that it can detect. This does not check for free space <br>
                             on the card.<br>
<br>
                                  ERR_BSAFE_SC_INVALID_CONFIG   - Notes is not configured to use a smartcard reader. <br>
                                                                  Does the PKCS11_Library notes.ini variable contains the<br>
                                                                  path to your PKCS#11 DLL? <br>
                                  ERR_BSAFE_INSERT_SMARTCARD    - No card is present in the reader<br>
                                  ERR_BSAFE_SC_UNSUPPORTED_FUNC - The card doesn't support multiple concurrent sessions<br>
                                  ERR_BSAFE_SC_KEY_CREATE       - The card doesn't provide the cryptographic capabilities <br>
                                                                  required by Notes. <br>
<br>
SC_manip_EnterIDFile:       Opens the indicated ID file.<br>
<br>
                                  Input Parameters:<br>
                                        pContext       - Valid context<br>
                                        pdwFlags       - Unused<br>
                                        *pdwParam1     - Length of the string in pvParam2<br>
                                        pvParam2       - BYTE*; null-terminated string holding path to the ID file to be <br>
                                                         opened<br>
<br>
                                  Output Parameters:<br>
                                        None<br>
<br>
                             Opens the indicated ID file and stores the hKFC in the SCMCTX. Will prompt for the ID file if<br>
                             none is provided and the caller  has a valid prompt set -- there is no console prompt for an<br>
                             ID file. If the ID is smartcard-enabled and SC_manip_EnterPIN was previously called, the ID <br>
                             file will be unlocked and opened for write.   This OpCode may be called repeatedly on a <br>
                             single context, effective switching the ID file being used. SC_manip_InitializeContext <br>
                             allocates a SCMCTX and initializes the PKCS #11 code. <br>
<br>
SC_manip_EnterPIN:           Logs the user into the Smartcard.<br>
<br>
                                  Input Parameters:<br>
                                        pContext       - Valid context<br>
                                        pdwFlags       - Unused<br>
                                        *pdwParam1     - PIN length<br>
                                        pvParam2       - BYTE*; null-terminated string containing the PIN for the current <br>
                                                         Smartcard<br>
<br>
                                  Output Parameters:<br>
                                        None<br>
<br>
                             If the token has a protected authentication path, this will trigger the protected authentication<br>
                             path. Otherwise, an explicit PIN will be passed to C_Login and a NULL or zero-length PIN will cause  <br>
                             Notes to prompt for the PIN.  If SC_manip_EnterIDFile was previously called and that ID file is <br>
                             smartcard-enabled, this OpCode will unlock the ID file and re-open the hKFC for write.<br>
<br>
SC_manip_SCEnableID:         Smartcard-enable the &quot;entered&quot; ID file with the current Smartcard.<br>
<br>
                                 Input Parameters:<br>
                                       pContext       - Valid context<br>
                                       pdwFlags       - Unused<br>
                                       *pdwParam1     - Password length<br>
                                       pvParam2       - BYTE*; null-terminated password for the ID file<br>
<br>
                                 Output Parameters:<br>
                                       None<br>
<br>
                             Obviously, must be called after SC_manip_EnterIDFile and SC_manip_EnterPIN. If a NULL or zero-length <br>
                             password is passed in, Notes will prompt for the ID file's password. <br>
                             Returns ERR_BSAFE_CERT_ALREADY_IN_ID_FILE if the ID file is already smartcard-enabled. <br>
<br>
SC_manip_PushInetKey:        Pushes the private key associated with the current signing internet certificate onto the Smartcard. <br>
<br>
                                 Input Parameters:<br>
                                       pContext       - Valid context<br>
                                       pdwFlags       - Unused<br>
                                       pdwParam1      - Unused<br>
                                       pvParam2       - Unused<br>
<br>
                                 Output Parameters:<br>
                                       None<br>
<br>
                             Future versions of this opcode will allow the administrator to specify which certificate they want<br>
                             to push onto the Smartcard. <br>
<br>
SC_manip_FindMatchedCerts:   Initializes a search for importable certificates and private keys on a Smartcard.  <br>
<br>
                                 Input Parameters:<br>
                                       pContext       - Valid context<br>
                                       pdwFlags       - Unused<br>
                                       pdwParam1      - Must point to a DWORD<br>
                                       pvParam2       - Unused<br>
<br>
                                 Output Parameters:<br>
                                       *pdwParam1     - Number of matching certs found<br>
<br>
                             The number of importable certs found is returned in *pdwParam1. This function does not require an ID<br>
                             file (nor a PIN login, although many cards will not yield up useful or complete information without <br>
                             one), as it can be used for informational purposes only.  The range of valid ordinals for <br>
                             SC_manip_GetMatchedCert and SC_manip_InetCert is from 0 to *pdwParam1-1 , inclusive. This OpCode can <br>
                             take a considerable amount of time to complete, as it performs a number of searches on a medium that <br>
                             is traditionally extremely slow.<br>
<br>
SC_manip_GetMatchedCert:     Examines the certificates that are available for import from the Smartcard into the ID file.<br>
<br>
                                 Input Parameters:<br>
                                       pContext       - Valid context<br>
                                       pdwFlags       - Unused<br>
                                       *pdwParam1     - The ordinal of the pair to be returned. [0...N-1]<br>
                                       pvParam2       - Optional; points to allocated SC_MANIP_IMPORTABLE_CERT<br>
<br>
                                 Output Parameters:<br>
                                       *pdwParam1     - Returns the size used/needed by the SC_MANIP_IMPORTABLE_CERT<br>
                                       *pvParam2      - If non-NULL and sufficiently large, filled in SC_MANIP_IMPORTABLE_CERT<br>
<br>
                             This must be called after SC_manip_FindMatchedCerts, as it relies on the information that was stored <br>
                             in the SCMCTX.<br>
<br>
SC_manip_ImportInetCert:     Reads the indicated certificate from the Smartcard.<br>
<br>
                                 Input Parameters:<br>
                                       pContext       - Valid context<br>
                                       pdwFlags       - Unused<br>
                                       *pdwParam1     - The ordinal of the pair to be imported<br>
                                       pvParam2       - Unused<br>
<br>
                                 Output Parameters:<br>
                                       None<br>
<br>
                             Reads the indicated certificate from the Smartcard, and stores the certificate, public key, and a <br>
                             reference to the private key in the Notes ID file. If the certificate can be used for signing, then <br>
                             it will become the default S/MIME signing certificate. Must be called after SC_manip_EnterIDFile, <br>
                             SC_manip_EnterPIN, and SC_manip_FindMatchingCerts.<br>
<br>
<br>
SC_manip_RefreshTokenInfo    Refreshes the token identification information that is stored in the ID file.<br>
<br>
                                 Input Parameters:<br>
                                       pContext       - Valid context<br>
                                       pdwFlags       - Unused<br>
                                       *pdwParam1     - Unused <br>
                                       pvParam2       - Unused<br>
<br>
                                 Output Parameters:<br>
                                       None<br>
<br>
                             Must be called after SC_manip_EnterIDFile and SC_manip_EnterPIN.<br>
<br>
SC_manip_PushKyrKey          Pushes the private key from an SSL keyring file onto a smartcard or a PKCS#11-based cryptographic<br>
                             accelerator.<br>
                                 <br>
                                 Input Parameters:<br>
                                       pContext       - Must have been be initialized<br>
                                       pdwFlags       - NULL<br>
                                       pdwParam1      - NULL<br>
                                       pvParam2       - Path to keyring file<br>
<br>
                                 Output Parameters:<br>
                                       None<br>
<br>
                             Pushes the private key from an SSL keyring file onto a smartcard or, more likely, a PKCS#11-based <br>
                             cryptographic accelerator.  SC_manip_PushKyrKey can only be called if the server's ID file has <br>
                             already been smartcard-enabled, potentially via SC_manip_SCEnableID, and it must be called after <br>
                             InitializeContext, SC_manip_EnterIDFile, and SC_manip_EnterPIN. <br>
<br>
SC_manip_PushNotesKey        Pushes a &quot;large&quot; (1024 or 2048-bit) Notes key onto a smartcard. <br>
                                  <br>
                                 Input Parameters:<br>
                                       pContext       - Must have been be initialized<br>
                                       pdwFlags       - NULL<br>
                                       pdwParam1      - NULL<br>
                                       pvParam2       - NULL<br>
<br>
                                 Output Parameters:<br>
                                       None<br>
<br>
                             Writes the (BER-encoded) Notes domestic private key to a  smartcard, make the key recoverable, <br>
                             and replaces the key in the ActiveUDO with a pointer to the key on the card.  <br>
                             SC_manip_PushNotesKey can only be called if the ID file has already been smartcard-enabled, <br>
                             potentially via SC_manip_SCEnableID, and it must be called after InitializeContext,    <br>
                             SC_manip_EnterIDFile, and SC_manip_EnterPIN.<br>
</ul>
<tt>&nbsp; &nbsp; SC_manip_EnterIDPassword &nbsp; &nbsp;Unlock the non-smartcard-enabled ID file entered through EnterIDFile with the supplied password. </tt><br>
<tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If *pdwParam1 and pvParam2 are not passed in, the user will be prompted for the password, if &nbsp;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;possible.</tt><br>

<ul>                                 Input Parameters:<br>
                                       pContext       - Must have been be initialized<br>
                                       pdwFlags       - NULL<br>
                                       pdwParam1      - <tt>Length of ID file password, if any</tt><br>
                                       pvParam2       - <tt>Points to ID file password, if any</tt><br>
<br>
                                 Output Parameters:<br>
                                       None<br>
</ul>
<tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt>  SC_manip_EnterIDPassword is used before the SC_manip_LockIDWithKeyRO opcode in order to unlock the <br>
                                ID file that is about to be smartcard-enabled, if the ID file was previously not smartcard-enabled.<br>
<br>
<tt><font color="#FF0000">&nbsp; &nbsp;</font></tt><tt>SC_manip_FindAllKeys &nbsp; &nbsp; &nbsp; &nbsp; Acquire all keys from all smartcards and return the number of keys available to the caller.</tt><br>

<ul>                                 Input Parameters:<br>
                                       pContext       - Must have been be initialized<br>
                                       pdwFlags       - NULL<br>
                                       pdwParam1      - Must point to a DWORD<br>
                                       pvParam2       - NULL<br>
<br>
                                 Output Parameters:<br>
                                        pdwParam1      - <tt>Filled in </tt><tt>with number of certs available</tt><br>
</ul>
                                SC_manip_FindAllKeys can be used with SC_manip_GetMatchedCert in the same fashion as <br>
                                SC_manip_FindMatchedCerts to find private RSA keys without matching certificates.  These keys cannot<br>
                                be imported into the ID file, due to the lack of matching certificates, but they can be used with <br>
                                SC_manip_LockIDWithKeyRO and SC_manip_LockIDWithKeyRnd to secure the ID file. <br>
<br>
<tt><font color="#FF0000">&nbsp; &nbsp;</font></tt><tt>SC_manip_LockIDWithKeyRO &nbsp; &nbsp; Smartcard-enable the ID file by encrypting it with a password-equivalent generated by signing a <br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;random seed value. This opcode will work with most read-only ID files. </tt><br>
<tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This is a valid upgrade path for regular smartcard-enabled ID files. SC_manip_EnterIDPassword must <br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be used before calling this function with non-smartcard-enabled ID files.</tt><br>

<ul>                                 Input Parameters:<br>
                                       pContext       - Must have been be initialized<br>
                                       pdwFlags       - <tt>Currently unused</tt><br>
                                       pdwParam1      - <tt>Ordinal of the key to use</tt><br>
                                       pvParam2       - <tt>Currently unused</tt><br>
<br>
                                 Output Parameters:<br>
                                       None<br>
</ul>
                                This is currently the recommended technique for protecting an ID file with a smartcard. This opcode <br>
                                uses the same mechanism as the  &quot;Lock ID with Key on Smartcard&quot; menu option that is accessible from <br>
                                the &quot;Other Actions&quot; button on the &quot;Your Certificates&quot; pane of the User Security Dialog when a <br>
                                certificate corresponding to a private key on a smartcard has been selected.   An ID file protected <br>
                                in this fashion cannot be used with a Notes client or Domino server before ND7, but can be recovered <br>
                                through the ID File Recovery process. <br>
<br>
<tt>&nbsp; &nbsp;SC_manip_LockIDWithKeyRnd &nbsp; &nbsp;Smartcard-enable the ID file by encrypting it with a symmetric key that is wrapped by a key on the <br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;token. This is a valid upgrade path for regular smartcard-enabled ID files. SC_manip_EnterIDPassword <br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;must be used before calling this function with non-smartcard-enabled ID files.</tt><br>

<ul>                                 Input Parameters:<br>
                                       pContext       - Must have been be initialized<br>
                                       pdwFlags       - <tt>Currently unused</tt><br>
                                       pdwParam1      - <tt>Ordinal of the key to use</tt><br>
                                       pvParam2       - <tt>Currently unused</tt><br>
<br>
                                 Output Parameters:<br>
                                       None<br>
</ul>
                                This technique will only work with a small set of smartcards with substantially above-average <br>
                                cryptographic support, including performing symmetric encryption in hardware; in most cases,  <br>
                                SC_manip_LockIDWithKeyRO should be used instead. As ID File Recovery will not be able to recover an <br>
                                ID file protected with this technique, this function has been effectively deprecated in favor of <br>
                                SC_manip_LockIDWithKeyRO. 


**See Also :**
[SC_MANIP_IMPORTABLE_CERT](/domino-c-api-docs/reference/Data/SC_MANIP_IMPORTABLE_CERT)
[SECManipulateSC](/domino-c-api-docs/reference/Func/SECManipulateSC)
---
