




<!--
 /\* Font Definitions \*/
 @font-face
 {font-family:Helv;
 panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
 {font-family:"Cambria Math";
 panose-1:2 4 5 3 5 4 6 3 2 4;}
 /\* Style Definitions \*/
 p.MsoNormal, li.MsoNormal, div.MsoNormal
 {margin-top:0cm;
 margin-right:0cm;
 margin-bottom:8.0pt;
 margin-left:0cm;
 line-height:107%;
 font-size:11.0pt;
 font-family:"Calibri",sans-serif;}
.MsoChpDefault
 {font-size:11.0pt;}
.MsoPapDefault
 {margin-bottom:8.0pt;
 line-height:107%;}
 /\* Page Definitions \*/
 @page WordSection1
 {size:612.0pt 792.0pt;
 margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
 {page:WordSection1;}
-->




**Initial Release 6**



**Function : Extension Manager; Mail;
SMTP**



**SMTPMessageAcceptEMCallback** **- Extension
Manager callback for EM\_SMTPMESSAGEACCEPT**


**----------------------------------------------------------------------------------------------------------**



**Note:** This function is only available as an Extension Manager callback
-- you cannot call this function directly.


 


**#include <extmgr.h>**



STATUS
LNPUBLIC **SMTPMessageAcceptEMCallback(**  

      DWORD  SessionID,  

      NOTEHANDLE  Note,  

      char \*SMTPReply,  

      DWORD  SMTPReplyLength**);**



**Description :**



EM\_SMTPMESSAGEACCEPT
is called following the receipt of "end of mail data indicator", a
line containing a single period, and itemization of the MIME stream into an
in-memory note.


 


Following
the receipt of the "end of mail data indicator", the resulting stream
is itemized to an in-memory note.  The Extension Manager EM\_BEFORE notification
type for the EM\_SMTPMESSAGEACCEPT event occurs following itemization but prior
to adding the note to the mailbox.  If the callback routine returns STATUS of
NOERROR, the Domino SMTP server will stop further processing of the message. 
By default a success response is generated by core Domino code when NOERROR
STATUS has been returned. It is also possible for the callback routine to
intercept the message and deposit to database where scans can be performed. 
The Callback routine can make changes to the note in the EM\_BEFORE event but
should not attempt to close the note as this is done by the core code.  


 


The
Extension Manager EM\_AFTER notification type for the EM\_SMTPMESSAGEACCEPT event
occurs after the SMTP listener task attempted to submit the message to the
mailbox but prior to sending a reply.  The Callback routines for the EM\_AFTER
notification can change the reply returned to the connecting host however, care
must be taken not to change the reply code from success to error or vice-versa
as this would cause the sender-SMTP and receiver-SMTP servers to be out of
synch.


 


**Parameters :**



Input :  

SessionID  -  Unique session identifier for the current session.  

  

Note  -  Handle to the note containing the itemized message.  

  

SMTPReplyLength  -  Size of buffer allocated to modify SMTPReply.  

  




Output :  

(routine)  -  Return status from the call   

EM\_BEFORE event: NOERROR, Domino silently deletes message.  ERR\_EM\_CONTINUE,
Domino accepts message for delivery  Anything else, Domino rejects message.  

EM\_AFTER event:  Value other than ERR\_EM\_CONTINUE is ignored.  

  

  

SMTPReply  -  SMTP Response that will be returned to the connecting host.  
EM\_BEFORE event: NULL.  EM\_AFTER event: NULL terminated string containing
RFC821 defined SMTP reply.    

  




 **See Also :**


**[EM\_xxx](notes:///8525872100478C66/61FD4E9848264AD28525620B006BA8BD/CCB2911F1DF6C7AF8525681000480140)**



----------------------------------------------------------------------------------------------------------


 





