




<!--
 /\* Font Definitions \*/
 @font-face
 {font-family:Courier;
 panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
 {font-family:Helv;
 panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
 {font-family:"Cambria Math";
 panose-1:2 4 5 3 5 4 6 3 2 4;}
 /\* Style Definitions \*/
 p.MsoNormal, li.MsoNormal, div.MsoNormal
 {margin-top:0cm;
 margin-right:0cm;
 margin-bottom:8.0pt;
 margin-left:0cm;
 line-height:107%;
 font-size:11.0pt;
 font-family:"Calibri",sans-serif;}
.MsoChpDefault
 {font-size:11.0pt;}
.MsoPapDefault
 {margin-bottom:8.0pt;
 line-height:107%;}
 /\* Page Definitions \*/
 @page WordSection1
 {size:612.0pt 792.0pt;
 margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
 {page:WordSection1;}
-->




**Initial Release 5.0**



**Function : Compound Text**



**CompoundTextAddTextExt** **- Writes
text to a CompoundText context.**


**----------------------------------------------------------------------------------------------------------**



**#include <easycd.h>**



STATUS
LNPUBLIC **CompoundTextAddTextExt(**  

      DHANDLE  hCompound,  

      DWORD  dwStyleID,  

      FONTID  FontID,  

      char far \*pchText,  

      DWORD  dwTextLen,  

      char far \*pszLineDelim,  

      DWORD  dwFlags,  

      NLS\_PINFO  pInfo**);**



**Description :**



NOTE: This
function replaces the deprecated function CompoundTextAddText.


 


      This
routine writes text to a CompoundText context.  This accepts text from a buffer
or from a file. The text may contain newline characters and/or other line
delimiters.  

  

This routine is most appropriate when you do not know the format of the text
you want written to the CompoundText context (for example, you read the text
from a file and want to turn it into CD records).  The text is parsed into
lines and/or paragraphs before it is written to the context.  

  




CompoundTextAddTextExt
can convert up to approximately 5 megabytes of text.  Each line of text,
identified by a line delimiter, is stored as one CDTEXT record.  If a line of
text is longer than approximately 16k with no line delimiter, a new CDTEXT
record is written.  The creation of CDPARAGRAPH records is controlled by the
COMP\_PARA\_LINE and COMP\_PARA\_BLANK\_LINE flags;  see COMP\_xxx for a description
of these flags.  A CDPARAGRAPH record can only be inserted when a line
delimiter is found.  If the input text contains more than 64k of text with no
line delimiter, the paragraph generated by CompoundTextAddTextExt cannot be
read by the Notes editor.


  

If the pInfo parameter is specified, the text will be translated (imported)
into Domino format (LMBCS) using the specified character set.  Specify NULL for
pInfo if the text is in LMBCS format already.  

  

To specify a character set, call NLS\_load\_charset first, specifying the file
name of the appropriate character set. NLS\_load\_charset returns a pointer to
use as the pInfo parameter value.


 


**Parameters :**



Input :  

hCompound  -  Handle of the CompoundText context.  

  

dwStyleID  -  CompoundText style ID as defined by a previous call to
CompoundTextDefineStyle, or STYLE\_ID\_SAMEASPREV to use the same style as the
last call.  

  

FontID  -  Specifies the FONTID.  

  

pchText  -  When the COMP\_FROM\_FILE flag is not specified, this parameter
points to a buffer in memory containing the text.  When the COMP\_FROM\_FILE flag
is specified, this parameter points to a null-terminated file pathname.  

  

dwTextLen  -  Length of text contained in the buffer when the COMP\_FROM\_FILE
flag is not specified.  This parameter is ignored when the COMP\_FROM\_FILE flag
is specified.  

  

pszLineDelim  -  Pointer to a null-terminated string of line delimiter(s).    

  

A text line ends at the matching delimiter string location, or at the end of
the text buffer/file if not match is encountered.   

  

When the "special" line delimiter "\r\n" is specified,
CompoundTextAddTextExt will correctly handle text lines delimited by
"\n", "\r", "\n\r" and "\r\n".  This
provides platform independence.  

  

When a multi character line delimeter is specified other than "\r\n"
(such as "\v\f\r\n"), the routine will break the line only if the
exact character sequence is found in the text string.  

  

When a single character line delimiter is specified (such as "\n"),
the routine is able to make use of faster LNL routines to break the text into
lines.  

  

dwFlags  -  (Optional)  Compound text conversion flags - may be 0 or a
combination of flags;  see COMP\_xxx for compound text flags.  

  

pInfo  -  (Optional)  Pointer to an NLS\_INFO structure.  

  




Output :  

(routine)  -  Return status from this call:   

  

NOERROR - Successfully added text to compound text context.  

  

ERR\_xxx - Errors returned by lower level functions. Call to OSLoadString to
translate the error to a string for display.  

  

  




 **Sample Usage :**


  

COMPOUNDSTYLE  Style;  

STATUS         Status;  

DHANDLE         hCompound;  

DWORD          dwNormalStyle;  

char               \*pszTree = "They cannot see the forest \nfor the
trees.";  

char               \*pszDogs = "It was for \nthe dogs.";


 


  

Status = CompoundTextCreate(NULLHANDLE, NULL, &hCompound);  

if (Status != NOERROR)  

    return Status;  

  

CompoundTextInitStyle(&Style);  

Status = CompoundTextDefineStyle( hCompound  

                                  "Normal",  

                                  &Style,  

                                  &dwNormalStyle);  

                                     

Status = CompoundTextAddTextExt(hCompound,  

                                dwNormalStyle,  

                                DEFAULT\_FONT\_ID,  

                                pszTree,  

                                (DWORD)strlen(pszTree),  

                                "\r\n",  

                                COMP\_PRESERVE\_LINES,  

                                NULL);  

if (Status != NOERROR)  

{  

CompoundTextDiscard(hCompound);  

return Status;  

}  

  

Status = CompoundTextAddTextExt(hCompound,  

                                dwNormalStyle,  

                                DEFAULT\_FONT\_ID,  

                                pszDogs,  

                                (DWORD)strlen(pszDogs),  

                                "\r\n",  

                                COMP\_PRESERVE\_LINES,  

                                NULL);  

if (Status != NOERROR)  

{  

CompoundTextDiscard(hCompound);  

return Status;  

}  

...


 **See Also :**


**[NLS\_load\_charset](NLS_load_charset.md)**


**[CompoundTextAddParagraphExt](CompoundTextAddParagraphExt.md)**


**[CompoundTextDefineStyle](CompoundTextDefineStyle.md)**


**[COMP\_xxx](notes:///852584E300582C9D/61FD4E9848264AD28525620B006BA8BD/00A300B60007000185255E9F00674123)**


**[STYLE\_ID\_SAMEASPREV](STYLE_ID_SAMEASPREV.md)**



----------------------------------------------------------------------------------------------------------


 





